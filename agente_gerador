# This is a sample Python script.

# Press Shift+F10 to execute it or replace it with your code.
# Press Double Shift to search everywhere for classes, files, tool windows, actions, and settings.


import time
from spade.agent import Agent
from spade.behaviour import OneShotBehaviour
from spade.message import Message
import random
import numpy as np


class Gerador(Agent):
    # gera coeficientes
    a = random.randint(-1000, 1000)
    b = random.randint(-1000, 1000)
    c = random.randint(-1000, 1000)
    d = random.randint(-1000, 1000)
    grau_funcao = random.randint(1, 3)
    lista_1grau = []
    lista_1grau[0] = a
    lista_1grau[1] = b
    lista_2grau = []
    lista_2grau[0] = a
    lista_2grau[1] = b
    lista_2grau[2] = c
    lista_3grau = []
    lista_3grau[0] = a
    lista_3grau[1] = b
    lista_3grau[2] = c
    lista_3grau[3] = d

    # envia a função para o agente
    class InformBehav(OneShotBehaviour):

        async def run(self):
            print("InformBehav running")
            msg = Message(to="receiver@your_xmpp_server")  # Instantiate the message
            msg.set_metadata("performative", "inform")  # Set the "inform" FIPA performative
            msg.set_metadata("ontology", "myOntology")  # Set the ontology of the message content
            msg.set_metadata("language", "OWL-S")  # Set the language of the message content
            # Set the message content
            if Gerador.grau_funcao == 1:
                msg.body = Gerador.lista_1grau
            if Gerador.grau_funcao == 2:
                msg.body = Gerador.lista_2grau
            if Gerador.grau_funcao == 3:
                msg.body = Gerador.lista_3grau

            await self.sent(msg)
            print("Message sent!")

            # set exit_code for the behaviour
            self.exit_code = "Job Finished!"

            # stop agent from behaviour
            await self.agent.stop()


async def setup(self):
    print("SenderAgent started")
    self.info = self.InformBehav()
    self.add_behaviour(self.info)


if __name__ == "__main__":
    agent = Gerador("aulaufsc@jix.im", "digite_senha")
    agent.web.start(hostname="127.0.0.1", port="10000")
    agent.start()

    while agent.is_alive():
        try:
            time.sleep(1)
        except KeyboardInterrupt:
            agent.stop()
            break
    print("Agent finished with exit code: {}".format(agent.exit_code))
